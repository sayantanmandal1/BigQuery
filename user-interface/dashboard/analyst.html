<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Knowledge Intelligence - Analyst Workbench</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="analyst.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-microscope me-2"></i>
                Analyst Workbench
            </a>
            <div class="navbar-nav ms-auto">
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-tie me-1"></i>
                        Analyst View
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="index.html">Executive Dashboard</a></li>
                        <li><a class="dropdown-item" href="#" onclick="showSettings()">Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#">Logout</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 sidebar">
                <div class="sidebar-content">
                    <h6 class="sidebar-heading">Data Sources</h6>
                    <div class="list-group list-group-flush">
                        <a href="#" class="list-group-item list-group-item-action" onclick="loadDataSource('enterprise_knowledge')">
                            <i class="fas fa-database me-2"></i>
                            Enterprise Knowledge
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="loadDataSource('financial_data')">
                            <i class="fas fa-chart-line me-2"></i>
                            Financial Data
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="loadDataSource('customer_data')">
                            <i class="fas fa-users me-2"></i>
                            Customer Data
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="loadDataSource('operational_data')">
                            <i class="fas fa-cogs me-2"></i>
                            Operational Data
                        </a>
                    </div>

                    <h6 class="sidebar-heading mt-4">Analysis Tools</h6>
                    <div class="list-group list-group-flush">
                        <a href="#" class="list-group-item list-group-item-action" onclick="showSemanticSearch()">
                            <i class="fas fa-search me-2"></i>
                            Semantic Search
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="showPredictiveAnalysis()">
                            <i class="fas fa-crystal-ball me-2"></i>
                            Predictive Analysis
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="showMultimodalAnalysis()">
                            <i class="fas fa-images me-2"></i>
                            Multimodal Analysis
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" onclick="showAnomalyDetection()">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            Anomaly Detection
                        </a>
                    </div>

                    <h6 class="sidebar-heading mt-4">Saved Queries</h6>
                    <div class="list-group list-group-flush" id="savedQueries">
                        <a href="#" class="list-group-item list-group-item-action">
                            <i class="fas fa-bookmark me-2"></i>
                            Revenue Trends Q4
                        </a>
                        <a href="#" class="list-group-item list-group-item-action">
                            <i class="fas fa-bookmark me-2"></i>
                            Customer Churn Analysis
                        </a>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 main-content">
                <!-- Query Builder Section -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-search me-2"></i>
                                    Intelligent Query Builder
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-8">
                                        <div class="mb-3">
                                            <label for="queryInput" class="form-label">Natural Language Query</label>
                                            <textarea class="form-control" id="queryInput" rows="3" 
                                                placeholder="e.g., Show me revenue trends for the last quarter and predict next month's performance"></textarea>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label for="analysisType" class="form-label">Analysis Type</label>
                                                <select class="form-select" id="analysisType">
                                                    <option value="semantic">Semantic Search</option>
                                                    <option value="predictive">Predictive Analysis</option>
                                                    <option value="multimodal">Multimodal Analysis</option>
                                                    <option value="anomaly">Anomaly Detection</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="timeRange" class="form-label">Time Range</label>
                                                <select class="form-select" id="timeRange">
                                                    <option value="7d">Last 7 days</option>
                                                    <option value="30d">Last 30 days</option>
                                                    <option value="90d">Last 90 days</option>
                                                    <option value="1y">Last year</option>
                                                    <option value="all">All time</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="d-grid gap-2 h-100 d-flex flex-column justify-content-center">
                                            <button class="btn btn-primary btn-lg" onclick="executeQuery()">
                                                <i class="fas fa-play me-2"></i>
                                                Execute Query
                                            </button>
                                            <button class="btn btn-outline-secondary" onclick="saveQuery()">
                                                <i class="fas fa-save me-2"></i>
                                                Save Query
                                            </button>
                                            <button class="btn btn-outline-info" onclick="showQueryHistory()">
                                                <i class="fas fa-history me-2"></i>
                                                Query History
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="row">
                    <!-- Data Visualization -->
                    <div class="col-lg-8">
                        <div class="card h-100">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-area me-2"></i>
                                    Analysis Results
                                </h5>
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="changeVisualization('chart')">
                                        <i class="fas fa-chart-line"></i>
                                    </button>
                                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="changeVisualization('table')">
                                        <i class="fas fa-table"></i>
                                    </button>
                                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="changeVisualization('map')">
                                        <i class="fas fa-map"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="visualizationContainer">
                                    <div class="text-center py-5 text-muted">
                                        <i class="fas fa-chart-area fa-4x mb-3 opacity-25"></i>
                                        <h5>No Analysis Results</h5>
                                        <p>Execute a query to see visualization results here.</p>
                                    </div>
                                </div>
                                <canvas id="analysisChart" style="display: none;"></canvas>
                                <div id="analysisTable" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Insights Panel -->
                    <div class="col-lg-4">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-lightbulb me-2"></i>
                                    AI Insights
                                </h5>
                            </div>
                            <div class="card-body">
                                <div id="insightsPanel">
                                    <div class="text-center py-4 text-muted">
                                        <i class="fas fa-lightbulb fa-3x mb-3 opacity-25"></i>
                                        <p>AI-generated insights will appear here after query execution.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Explorer Section -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-table me-2"></i>
                                    Data Explorer
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <select class="form-select" id="tableSelect" onchange="loadTableData()">
                                            <option value="">Select a table...</option>
                                            <option value="enterprise_knowledge_base">Enterprise Knowledge Base</option>
                                            <option value="generated_insights">Generated Insights</option>
                                            <option value="user_interactions">User Interactions</option>
                                            <option value="forecast_results">Forecast Results</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <input type="text" class="form-control" id="searchFilter" 
                                               placeholder="Search data..." onkeyup="filterTableData()">
                                    </div>
                                    <div class="col-md-4">
                                        <button class="btn btn-outline-primary" onclick="exportTableData()">
                                            <i class="fas fa-download me-2"></i>
                                            Export Data
                                        </button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover" id="dataTable">
                                        <thead>
                                            <tr>
                                                <th colspan="100%" class="text-center text-muted py-4">
                                                    Select a table to explore data
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                                <nav>
                                    <ul class="pagination justify-content-center" id="tablePagination">
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Query History Modal -->
    <div class="modal fade" id="queryHistoryModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Query History</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="list-group" id="queryHistoryList">
                        <!-- Query history items will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Save Query Modal -->
    <div class="modal fade" id="saveQueryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Save Query</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="saveQueryForm">
                        <div class="mb-3">
                            <label for="queryName" class="form-label">Query Name</label>
                            <input type="text" class="form-control" id="queryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="queryDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="queryDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="queryTags" class="form-label">Tags</label>
                            <input type="text" class="form-control" id="queryTags" 
                                   placeholder="Enter tags separated by commas">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="submitSaveQuery()">Save Query</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="analyst.js"></script>
</body>
</html>